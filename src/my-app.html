<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="shared-styles.html">

<!-- Intl polyfill -->
<script src="../bower_components/intl/dist/Intl.min.js"></script>

<dom-module id="my-app">
  <template>
    <style is="custom-style">
      /* TODO: REMOVE EXCESS STYLES */
      /* COLOR THEME FOR APP */
      :host {
        display: block;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
      }

      [hidden] {
        display: none !important;
      }

      h1 {
        font-size: 7em;
        color: #FFF;
        margin: 0;
      }

      p {
        font-size: 40px;
        color: #FFF;
        padding: 0;
        margin: 0;
      }

      a {
        text-decoration: none;
        color: #FFF;
      }

      a:hover {
        color: #CFD8DC;
      }

      a#sb {
        color: #FFF;
      }

      #top-bar {
        display: flex;
        flex-direction: row;
        width: 100%;
        height: 64px;
        align-items: center;
        background: #FF9800;
        color: white;
        font-size: 19px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.5);
      }

      .item {
        padding: 8px;
      }

      .title {
        padding-left: 16px;
      }

      .sign {
        padding-right: 16px;
      }

      #left {
        display: flex;
        width: 50%;
        justify-content: flex-start;
      }

      #right {
        display: flex;
        width: 50%;
        justify-content: flex-end;
      }

      #right-footer {
        width: 50%;
        padding-right: 16px;
        text-align: right;
      }

      #left-footer {
        padding-left: 16px;
        display: flex;
        width: 50%;
        color: #FFF;
      }

      #splash-content {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100vh;
        background-image: url('/images/splash.jpeg');
        background-position: center center;
        background-size: cover;
        align-items: center;
        justify-content: center;
      }

      #info-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        /*height: 600px;*/
        background: #FFF;
        padding-left: 8px;
        padding-right: 8px;
        font-size: 18px;
      }

      #footer {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        width: 100%;
        background: #FF9800;
        height: 64px;
      }

      .info {
        width: 70%;
        padding: 16px;
      }

      .line {
        width: 85%;
        height: 5px;
        border-radius: 2px;
        background: #FF9800;
        margin-top: 36px;
      }

      @media (max-width: 620px) {
        #splash-content {
          text-align: center;
          height: 60vh;
        }
        #info-content {
          font-size: 28px;
          background: #FFF;
        }
        #top-bar {
          font-size: 28px;
        }

        #footer {
          height: 100px;
        }
      }

      button {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        background: #3f51b5;
        min-width: 100px;
        color: white;
        border: none;
        border-radius: 3px;
        text-transform: uppercase;
        margin-right: 16px;
        padding: 12px;
        font-size: 14px;
        cursor: pointer;
      }
    </style>

    <firebase-app
      api-key="AIzaSyC0ni874mFgKx3zd7ZoGT7fIgdmNrm_ZoM"
      database-url="https://lettuce-go.firebaseio.com"
      auth-domain="lettuce-go.firebaseapp.com"
      storage-bucket="lettuce-go.appspot.com">
    </firebase-app>
    <firebase-auth id="googleAuth" user="{{user}}" provider="google"></firebase-auth>

    <div class="signin-view" id="signin" hidden>
    <div id="top-bar">
      <div id="left">
        <div class="item title">Let's Go</div>
      </div>
      <div id="right">
        <button on-tap="login" raised hidden$="[[offline]]">Sign In</button>
      </div>
    </div>
    <div id="splash-content">
      <h1>Let's GO</h1>
      <p id="adjective">An app for finding active friends.</p>
    </div>
    <div id="info-content">
      <div class="info" id="info_2">
        <h2>About</h2>
        Let's Go is an app that allows you to find new friends. It does this by using common activities.
        You simply add activities to your profile so people can find you, and then you search for people near you
        with similar activities. If you both request each other, your contact information is shared.
      </div>

      <div class="line"></div>

      <div class="info" id="info_1">
        <h2>Team</h2>
        Let's Go is built and maintaned by a small team of young students from Northern California.
        <ul>
          <li>Ryan McNeil - Founder and CEO</li>
          <li>Duncan Grubbs - Lead Developer</li>
          <li>Sebastian Boyd - Lead Backend Developer</li>
          <li>Luke Martel - Web Developer</li>
        </ul>
      </div>
    </div>

    <div id="footer">
      <div id="left-footer"><em><b>Copyright Â© <a target="_blank" id="sb" href="http://sebastianboyd.com">2016 SB Technology Holding International</a></b></em></div>
      <div id="right-footer"><a target="_blank" href="https://github.com/DHSDevelopersClub/app-challenge">Source Code</a></div>
    </div>

    </div>

    <moji-feed id="feed" offline="[[offline]]" language="[[language]]"></moji-feed>
  </template>

  <script>
    Polymer({
      is: 'my-app',

      behaviors: [
        Polymer.AppLocalizeBehavior
      ],

      properties: {
        offline: {
          type: Boolean,
          value: false
        },
      },

      ready: function() {
        this.loadResources(this.resolveUrl('locales.json'));

        this.offline = navigator.onLine === false;
        window.addEventListener('online', function() {
          this.offline = false;
        }.bind(this));
        window.addEventListener('offline', function() {
          this.offline = true;
        }.bind(this));

        this.addEventListener('language-changed', function(event) {
          this.language = event.detail.value;
        }.bind(this));

        this.$.googleAuth.auth.onAuthStateChanged(function(user) {
          if (!!user) {
            this.importHref(this.resolveUrl('moji-feed.html'), function() {
              this.$.feed.user = user;
              this.$.signin.hidden = true;
              this.$.feed.hidden = false;
              // We went from hidden to visible, so app-layout needs to recompute its size.
              this.$.feed.resizeHeader();
            });
          } else {
            this.$.signin.hidden = false;
            this.$.feed.hidden = true;
          }
        }.bind(this));
      },

      login: function() {
        this.$.googleAuth.signInWithPopup();
      }
    });
  </script>
</dom-module>
